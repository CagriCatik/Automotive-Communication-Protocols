"use strict";(self.webpackChunkvns=self.webpackChunkvns||[]).push([[9092],{73881:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"UDS/examples/Read-Data-by-Identifier","title":"Examples - 0x22","description":"Below are practical examples of how to implement the Read Data By Identifier (0x22) service, based on the UDS protocol (ISO 14229). These examples will include code snippets to simulate the service request and response using different tools, including Python and CAPL.","source":"@site/docs/UDS/04_examples/05_Read-Data-by-Identifier.md","sourceDirName":"UDS/04_examples","slug":"/UDS/examples/Read-Data-by-Identifier","permalink":"/Vehicle-Network-Standards/docs/UDS/examples/Read-Data-by-Identifier","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/UDS/04_examples/05_Read-Data-by-Identifier.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"udsSidebar","previous":{"title":"Examples - 0x27","permalink":"/Vehicle-Network-Standards/docs/UDS/examples/Security-Access"},"next":{"title":"Examples - 0x2E","permalink":"/Vehicle-Network-Standards/docs/UDS/examples/Write-Data-by-Identifier"}}');var t=s(74848),i=s(28453);const o={sidebar_position:5},d="Examples - 0x22",a={},l=[{value:"1. <strong>Python Example: Using <code>python-uds</code> Library</strong>",id:"1-python-example-using-python-uds-library",level:2},{value:"1.1. Install the <code>python-uds</code> Library",id:"11-install-the-python-uds-library",level:3},{value:"1.2. Python Code to Read Data by Identifier",id:"12-python-code-to-read-data-by-identifier",level:3},{value:"Key Points:",id:"key-points",level:2},{value:"2. <strong>CAPL Example: Simulating RDBI Request</strong>",id:"2-capl-example-simulating-rdbi-request",level:2},{value:"2.1. CAPL Code to Read Data by Identifier (0x22)",id:"21-capl-code-to-read-data-by-identifier-0x22",level:3},{value:"Key Points:",id:"key-points-1",level:2},{value:"3. <strong>Simulating UDS RDBI Request Using CANoe</strong> (Vector CANoe Simulation)",id:"3-simulating-uds-rdbi-request-using-canoe-vector-canoe-simulation",level:2},{value:"3.1. Setting Up the CANoe Simulation",id:"31-setting-up-the-canoe-simulation",level:3},{value:"3.2. Example CANoe Simulation Setup",id:"32-example-canoe-simulation-setup",level:3},{value:"4. <strong>Example: Testing Vehicle Speed (0x02)</strong>",id:"4-example-testing-vehicle-speed-0x02",level:2},{value:"4.1. Python Example: Request Vehicle Speed (Identifier <code>0x02</code>)",id:"41-python-example-request-vehicle-speed-identifier-0x02",level:3},{value:"4.2. CAPL Example: Request Vehicle Speed (Identifier <code>0x02</code>)",id:"42-capl-example-request-vehicle-speed-identifier-0x02",level:2},{value:"5. <strong>Conclusion</strong>",id:"5-conclusion",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"examples---0x22",children:"Examples - 0x22"})}),"\n",(0,t.jsxs)(n.p,{children:["Below are practical examples of how to implement the ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier (0x22)"})," service, based on the UDS protocol (ISO 14229). These examples will include code snippets to simulate the service request and response using different tools, including Python and CAPL."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"1-python-example-using-python-uds-library",children:["1. ",(0,t.jsxs)(n.strong,{children:["Python Example: Using ",(0,t.jsx)(n.code,{children:"python-uds"})," Library"]})]}),"\n",(0,t.jsxs)(n.p,{children:["We will use the ",(0,t.jsx)(n.code,{children:"python-uds"})," library, an open-source Python package that allows you to send and receive UDS messages. The example demonstrates how to send a ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier"})," request to an ECU and interpret the response."]}),"\n",(0,t.jsxs)(n.h3,{id:"11-install-the-python-uds-library",children:["1.1. Install the ",(0,t.jsx)(n.code,{children:"python-uds"})," Library"]}),"\n",(0,t.jsxs)(n.p,{children:["First, install the ",(0,t.jsx)(n.code,{children:"python-uds"})," library:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"pip install python-uds\n"})}),"\n",(0,t.jsx)(n.h3,{id:"12-python-code-to-read-data-by-identifier",children:"1.2. Python Code to Read Data by Identifier"}),"\n",(0,t.jsxs)(n.p,{children:["In this example, we\u2019ll use the ",(0,t.jsx)(n.code,{children:"python-uds"})," library to send a ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier (0x22)"})," request for the ECU software version (identifier ",(0,t.jsx)(n.code,{children:"0x01"}),") and retrieve the response."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import uds\r\nfrom uds.enums import Services\r\nfrom uds.services import ReadDataByIdentifier\r\nfrom uds.datatypes import Address\r\nimport time\r\n\r\n# Define the ECU address (example CAN address)\r\necu_address = Address("0x7E0")  # Common address for ECU on CAN bus\r\n\r\n# Create a UDS transport object (CAN transport in this case)\r\n# The `uds` library supports CAN and other transports; configure accordingly\r\ntransport = uds.transport.can.CANTransport(channel="can0", address=ecu_address)\r\n\r\n# Define the identifier for Software Version (example: 0x01)\r\ndata_identifier = [0x01]\r\n\r\n# Create a ReadDataByIdentifier service request\r\nservice_request = ReadDataByIdentifier(data_identifier)\r\n\r\n# Send the request and receive the response\r\nresponse = transport.request(service_request)\r\n\r\n# Print the response data (Software version, for example)\r\nprint("Received Response:")\r\nprint(response)\r\n\r\n# Example of interpreting the response\r\n# Assuming the response is: 0x62 0x01 0x01 0x00 0x02 0x03 (Software version: 1.0.2.3)\r\nif response.service_id == 0x62:\r\n    version_data = response.data[2:]  # Skip the identifier byte\r\n    software_version = ".".join([str(byte) for byte in version_data])\r\n    print(f"Software Version: {software_version}")\r\nelse:\r\n    print("Error: Invalid response")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"key-points",children:"Key Points:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CAN Address"}),": ",(0,t.jsx)(n.code,{children:"0x7E0"})," is typically the address for the ECU in a CAN network."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Transport Layer"}),": In this case, we're using ",(0,t.jsx)(n.strong,{children:"CAN"})," as the transport layer."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Request"}),": We're sending a ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier"})," request to retrieve the ECU's software version using identifier ",(0,t.jsx)(n.code,{children:"0x01"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Response"}),": The response is parsed to extract and display the software version (for example: ",(0,t.jsx)(n.code,{children:"1.0.2.3"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"2-capl-example-simulating-rdbi-request",children:["2. ",(0,t.jsx)(n.strong,{children:"CAPL Example: Simulating RDBI Request"})]}),"\n",(0,t.jsxs)(n.p,{children:["In ",(0,t.jsx)(n.strong,{children:"CAPL"})," (CAN Application Protocol Language), which is used in ",(0,t.jsx)(n.strong,{children:"Vector CANoe"})," and ",(0,t.jsx)(n.strong,{children:"CANalyzer"}),", you can implement UDS services directly for CAN simulation and testing."]}),"\n",(0,t.jsx)(n.h3,{id:"21-capl-code-to-read-data-by-identifier-0x22",children:"2.1. CAPL Code to Read Data by Identifier (0x22)"}),"\n",(0,t.jsxs)(n.p,{children:["This example demonstrates how to implement a ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier"})," request for the software version (identifier ",(0,t.jsx)(n.code,{children:"0x01"}),")."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-CAPL",children:'variables\r\n{\r\n  msTimer timeoutTimer;  // Timer for response timeout\r\n}\r\n\r\non start\r\n{\r\n  // Send a Read Data By Identifier (0x22) request for the Software Version (identifier 0x01)\r\n  output("Sending RDBI request for Software Version (0x01)...");\r\n\r\n  // Send UDS request on the CAN bus\r\n  byte request[8] = {0x22, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};  // 0x22 = RDBI, 0x01 = identifier for software version\r\n  output("Request: %x %x", request[0], request[1]);\r\n  output(request);\r\n\r\n  // Send message via CAN interface (assume CAN channel is configured)\r\n  outputMessage(0x7E0, request, 8);  // Assuming 0x7E0 is the ECU address\r\n\r\n  // Start timer for response timeout\r\n  setTimer(timeoutTimer, 1000);  // 1-second timeout\r\n}\r\n\r\non message 0x7E8  // Assuming ECU responds on CAN address 0x7E8\r\n{\r\n  byte response[8];\r\n  response = thisByte;\r\n\r\n  // Check the response service ID (should be 0x62 for successful response)\r\n  if (response[0] == 0x62) {\r\n    output("Received valid response for RDBI!");\r\n    output("Software Version: %x.%x.%x.%x", response[2], response[3], response[4], response[5]);\r\n  } else {\r\n    output("Error: Invalid response received.");\r\n  }\r\n}\r\n\r\non timer timeoutTimer\r\n{\r\n  output("Error: Response timeout!");\r\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"key-points-1",children:"Key Points:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Service ID"}),": We send ",(0,t.jsx)(n.code,{children:"0x22"})," for the ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier"})," service and ",(0,t.jsx)(n.code,{children:"0x01"})," for the software version identifier."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CAN Message"}),": The message is sent to address ",(0,t.jsx)(n.code,{children:"0x7E0"})," (ECU address) and waits for the response from ",(0,t.jsx)(n.code,{children:"0x7E8"})," (ECU response address)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Response Handling"}),": When the ECU responds with a message starting with ",(0,t.jsx)(n.code,{children:"0x62"}),", we interpret the response to extract and print the software version (e.g., ",(0,t.jsx)(n.code,{children:"1.0.2.3"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"3-simulating-uds-rdbi-request-using-canoe-vector-canoe-simulation",children:["3. ",(0,t.jsx)(n.strong,{children:"Simulating UDS RDBI Request Using CANoe"})," (Vector CANoe Simulation)"]}),"\n",(0,t.jsxs)(n.p,{children:["If you use ",(0,t.jsx)(n.strong,{children:"Vector CANoe"})," for UDS simulation, you can implement the ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier"})," service in a similar way to the CAPL example. In CANoe, you will use the ",(0,t.jsx)(n.strong,{children:"CAPL script"})," to send the request and receive the response. The configuration will include setting up the ECU simulation to respond with specific identifiers for testing."]}),"\n",(0,t.jsx)(n.h3,{id:"31-setting-up-the-canoe-simulation",children:"3.1. Setting Up the CANoe Simulation"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ECU Simulator"}),": Set up an ECU in CANoe to respond to UDS requests, including the ",(0,t.jsx)(n.code,{children:"0x22"})," service."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Database"}),": Use ",(0,t.jsx)(n.strong,{children:"DBC"})," files to define the CAN messages and signal mappings."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"32-example-canoe-simulation-setup",children:"3.2. Example CANoe Simulation Setup"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Message Configuration"}),": Define the CAN message for the ",(0,t.jsx)(n.code,{children:"0x22"})," request and its response."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CAPL Script"}),": Implement CAPL script to send the request and handle the response, as shown in the previous CAPL example."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["This example will ensure that the UDS ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier"})," service is successfully simulated and tested using Vector CANoe."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"4-example-testing-vehicle-speed-0x02",children:["4. ",(0,t.jsx)(n.strong,{children:"Example: Testing Vehicle Speed (0x02)"})]}),"\n",(0,t.jsxs)(n.h3,{id:"41-python-example-request-vehicle-speed-identifier-0x02",children:["4.1. Python Example: Request Vehicle Speed (Identifier ",(0,t.jsx)(n.code,{children:"0x02"}),")"]}),"\n",(0,t.jsxs)(n.p,{children:["Let\u2019s send a request to retrieve the ",(0,t.jsx)(n.strong,{children:"vehicle speed"})," using identifier ",(0,t.jsx)(n.code,{children:"0x02"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import uds\r\nfrom uds.enums import Services\r\nfrom uds.services import ReadDataByIdentifier\r\nfrom uds.datatypes import Address\r\n\r\n# Define ECU address\r\necu_address = Address("0x7E0")  # CAN address of the ECU\r\n\r\n# Define transport layer (CAN transport in this example)\r\ntransport = uds.transport.can.CANTransport(channel="can0", address=ecu_address)\r\n\r\n# Define vehicle speed identifier (0x02)\r\ndata_identifier = [0x02]\r\n\r\n# Create a ReadDataByIdentifier request for vehicle speed\r\nservice_request = ReadDataByIdentifier(data_identifier)\r\n\r\n# Send the request and get the response\r\nresponse = transport.request(service_request)\r\n\r\n# Process and print response\r\nprint("Received Response:")\r\nprint(response)\r\n\r\n# Example: Interpret vehicle speed response\r\nif response.service_id == 0x62:\r\n    vehicle_speed = int.from_bytes(response.data[2:], byteorder="big")  # Get speed (bytes 2 and 3)\r\n    print(f"Vehicle Speed: {vehicle_speed} km/h")\r\nelse:\r\n    print("Error: Invalid response")\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"42-capl-example-request-vehicle-speed-identifier-0x02",children:["4.2. CAPL Example: Request Vehicle Speed (Identifier ",(0,t.jsx)(n.code,{children:"0x02"}),")"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-CAPL",children:'on start\r\n{\r\n  byte request[8] = {0x22, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00};  // 0x22 = RDBI, 0x02 = Vehicle Speed\r\n  output("Sending RDBI request for Vehicle Speed (0x02)...");\r\n\r\n  // Send UDS message on CAN bus\r\n  outputMessage(0x7E0, request, 8);  // CAN address of ECU: 0x7E0\r\n\r\n  // Set timeout timer\r\n  setTimer(timeoutTimer, 1000);  // 1 second timeout\r\n}\r\n\r\non message 0x7E8  // Assuming the ECU responds on address 0x7E8\r\n{\r\n  byte response[8];\r\n  response = thisByte;\r\n\r\n  // Handle the response\r\n  if (response[0] == 0x62) {\r\n    output("Received valid response for RDBI.");\r\n    output("Vehicle Speed: %x", response[2] * 256 + response[\r\n\r\n3]);  // Speed value in km/h\r\n  } else {\r\n    output("Error: Invalid response");\r\n  }\r\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.h2,{id:"5-conclusion",children:["5. ",(0,t.jsx)(n.strong,{children:"Conclusion"})]}),"\n",(0,t.jsxs)(n.p,{children:["These examples show how to implement and simulate the ",(0,t.jsx)(n.strong,{children:"Read Data By Identifier (0x22)"})," service using Python and CAPL. By using tools like ",(0,t.jsx)(n.code,{children:"python-uds"}),", ",(0,t.jsx)(n.strong,{children:"Vector CANoe"}),", and ",(0,t.jsx)(n.strong,{children:"CAPL scripts"}),", you can simulate diagnostic interactions with ECUs, retrieve vehicle data (e.g., software version, vehicle speed), and integrate the service into vehicle testing and diagnostics workflows."]}),"\n",(0,t.jsx)(n.p,{children:"By following these examples, you should be able to implement UDS requests for various data identifiers in both real-world and simulated environments, and handle responses in an automated and robust manner."})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>d});var r=s(96540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);